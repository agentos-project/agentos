<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>agentos.virtual_env &mdash; AgentOS 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/main.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="agentos.utils" href="agentos.utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> AgentOS
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Component System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../repl_quickstart.html">Python REPL Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local_quickstart.html">Local Development Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example_agents.html">Example Agents</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="agentos.argument_set.html">agentos.argument_set</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.cli.html">agentos.cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.component.html">agentos.component</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.component_run.html">agentos.component_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.core.html">agentos.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.exceptions.html">agentos.exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.identifiers.html">agentos.identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.registry.html">agentos.registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.repo.html">agentos.repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.run.html">agentos.run</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.run_command.html">agentos.run_command</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.specs.html">agentos.specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="agentos.utils.html">agentos.utils</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">agentos.virtual_env</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AgentOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">API Documentation</a> &raquo;</li>
      <li>agentos.virtual_env</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/agentos.virtual_env.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-agentos.virtual_env">
<span id="agentos-virtual-env"></span><h1>agentos.virtual_env<a class="headerlink" href="#module-agentos.virtual_env" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentos.virtual_env.</span></span><span class="sig-name descname"><span class="pre">VirtualEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_venv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">venv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv" title="Permalink to this definition"></a></dt>
<dd><p>This class manages a Python virtual environment. It provides methods to
setup, enable, and disable virtual environments as well as utility methods
such as one to clear the whole virtual environment cache.</p>
<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_venv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">venv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.activate">
<span class="sig-name descname"><span class="pre">activate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.activate" title="Permalink to this definition"></a></dt>
<dd><p>Activates the virtual environment currently being managed. When
activated, an import statement (e.g. run by a Component) will execute
within the virtual environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.build_venv_for_component">
<span class="sig-name descname"><span class="pre">build_venv_for_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="agentos.registry.html#agentos.registry.Registry" title="agentos.registry.Registry"><span class="pre">agentos.registry.Registry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="agentos.identifiers.html#agentos.identifiers.ComponentIdentifier" title="agentos.identifiers.ComponentIdentifier"><span class="pre">agentos.identifiers.ComponentIdentifier</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pathlib.Path</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.build_venv_for_component" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new virtual environment based on the requirements specified
by the Component DAG rooted by Component <code class="docutils literal notranslate"><span class="pre">identifier</span></code>.  Every
<code class="docutils literal notranslate"><span class="pre">requirements_path</span></code> specified by a Component in the DAG will be pip
installed by AgentOS during the creation of the virtual environment.
If no Component in the DAG specifies a <code class="docutils literal notranslate"><span class="pre">requirements_path</span></code>, then no
virtual environment is created and the Component DAG will be run in the
outer Python environment.  Virtual environments are created in the
environment cache.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.clear_env_cache">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clear_env_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_cache_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_yes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.clear_env_cache" title="Permalink to this definition"></a></dt>
<dd><p>Completely removes all the virtual environments that have been created
for Components.  Pass True to <code class="docutils literal notranslate"><span class="pre">assume_yes</span></code> to run non-interactively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.create_virtual_env">
<span class="sig-name descname"><span class="pre">create_virtual_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.create_virtual_env" title="Permalink to this definition"></a></dt>
<dd><p>Creates the directory and objects that back the virtual environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.deactivate">
<span class="sig-name descname"><span class="pre">deactivate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.deactivate" title="Permalink to this definition"></a></dt>
<dd><p>Deactivates the virtual environment (i.e. re-activates the default
environment under which AgentOS was executed).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.from_registry">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_registry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">registry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="agentos.registry.html#agentos.registry.Registry" title="agentos.registry.Registry"><span class="pre">agentos.registry.Registry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#agentos.virtual_env.VirtualEnv" title="agentos.virtual_env.VirtualEnv"><span class="pre">agentos.virtual_env.VirtualEnv</span></a></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.from_registry" title="Permalink to this definition"></a></dt>
<dd><p>Given a Registry object, a Component name, and (optionally) a Component
version, this function instantiates and returns a virtual environment
that satisfies all requirements specified in the requirements_path keys
of all Components in the DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.from_registry_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_registry_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yaml_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#agentos.virtual_env.VirtualEnv" title="agentos.virtual_env.VirtualEnv"><span class="pre">agentos.virtual_env.VirtualEnv</span></a></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.from_registry_file" title="Permalink to this definition"></a></dt>
<dd><p>Given a path to a yaml registry file, a Component name, and
(optionally) a Component version, this function instantiates and
returns a virtual environment that satisfies all requirements specified
in the requirements_path keys of all Components in the DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.install_requirements_file">
<span class="sig-name descname"><span class="pre">install_requirements_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pip_flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.install_requirements_file" title="Permalink to this definition"></a></dt>
<dd><p>Installs the requirements_file pointed at by <cite>req_path</cite> into the
virtual environment. <code class="docutils literal notranslate"><span class="pre">pip_flags</span></code> is a dictionary of command-line
flags to path to pip during the installation, for example:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">{'-F':</span> <span class="pre">'https://example.com/foo/bar'}</span>
<span class="pre">`</span></code></p>
<p>results in pip being run with the following command-line flags:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">pip</span> <span class="pre">install</span> <span class="pre">..</span> <span class="pre">-F</span> <span class="pre">https://example.com/foo/bar</span>
<span class="pre">`</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.set_env_cache_path">
<span class="sig-name descname"><span class="pre">set_env_cache_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_cache_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pathlib.Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.set_env_cache_path" title="Permalink to this definition"></a></dt>
<dd><p>Allows overriding of the path of the environment cache. The environment
cache is where all the virtual environments for Components are created.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentos.virtual_env.VirtualEnv.set_environment_handling">
<span class="sig-name descname"><span class="pre">set_environment_handling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_venv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#agentos.virtual_env.VirtualEnv.set_environment_handling" title="Permalink to this definition"></a></dt>
<dd><p>Enables or disables virtual environment management.  If <code class="docutils literal notranslate"><span class="pre">use_venv</span></code> is
set to False, all public methods of this class will be no-ops.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="agentos.virtual_env.auto_revert_venv">
<span class="sig-prename descclassname"><span class="pre">agentos.virtual_env.</span></span><span class="sig-name descname"><span class="pre">auto_revert_venv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#agentos.virtual_env.auto_revert_venv" title="Permalink to this definition"></a></dt>
<dd><p>Use this context manager when you need to revert the Python environment to
whatever was in place before the managed block.  Useful in tests when an
exception might leave the environment in an unexpected state and cause
spurious test failures.</p>
<p>Usage example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">auto_revert_venv</span><span class="p">():</span>
    <span class="c1"># Do something here that may fail, leaving the env in a bad state</span>
<span class="c1"># Env guaranteed to be reset to its pre-managed-block state here</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="agentos.utils.html" class="btn btn-neutral float-left" title="agentos.utils" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, AgentOS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>